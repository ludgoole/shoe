import{h as K,j as W,k as ee,m as oe,n as L,o as le,p as te,d as R,q as ue,r as ne,e as ae}from"./element-plus-vendor.cd905b71.js";import{u as Q,a as re,b as O}from"./assets/index.6024a31e.js";import{P as X,ah as Z,a8 as se,r as k,ad as G,z as H,o as g,h as S,a6 as u,$ as r,X as ie,v as m,t as J,F as q,ap as P,j as z,a4 as y,Z as T,p as de,a5 as j,E as ce,bp as N,V as me}from"./vendor.18c76fc2.js";import{u as pe,a as fe}from"./use-form.48f3d133.js";import"./echarts-vendor.146610b4.js";import"./zrender-vendor.c3e0151a.js";const _e={class:"StockAdd"},be={flex:"~ 1","justify-end":""},ve=y(" \u53D6\u6D88 "),Ee=y(" \u63D0\u4EA4 "),De=X({__name:"AccountAdd",props:{onClose:null},emits:["on-submit"],setup(A,{emit:d}){const D=A,{uniqueBy:p,pickBy:b}=re(),{g_stock:c}=Z(Q()),V=J("emitter"),$=se(),C=k(),e=G({id:"",price:"",color:"",size:"",note:""}),B=G({id:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D27\u53F7",trigger:"blur"}],price:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EF7\u683C",trigger:"blur"}],color:[{required:!0,message:"\u8BF7\u9009\u62E9\u989C\u8272",trigger:"blur"}],size:[{required:!0,message:"\u8BF7\u9009\u62E9\u5C3A\u7801",trigger:"blur"}]}),w=n=>({value:n,label:n}),_=k(["001","002","110","111"].map(w)),x=k(["\u7EA2","\u7C89","\u6A59","\u9EC4","\u7EFF","\u9752","\u84DD","\u7D2B","\u68D5","\u9ED1","\u767D","\u7070"].map(w)),Y=k(["33","34","35","36","37","38","39","40","41","42","43","44","45"].map(w));V.off("onEdit"),V.on("onEdit",n=>{e.id=n.id,e.price=n.price,e.color=n.color,e.size=n.size,e.note=n.note}),H(()=>{var l;const n=o=>({value:`${o}`,label:`${o}`});_.value=p(c.value,"id").map(n),e.price=((l=c.value.find(o=>o.id===e.id))==null?void 0:l.price)||"",x.value=b(c.value.filter(o=>o.id===e.id),"color").map(o=>o.color).map(n),Y.value=b(c.value.filter(o=>o.id===e.id).filter(o=>o.color===e.color),"size").map(o=>o.size).sort().map(n)});async function I(n){!n||await n.validate((l,o)=>{const{id:f,color:s,size:i}=e,v=c.value.find(E=>[E.id,E.color,E.size].join()===[f,s,i].join());if(l&&v){const E=c.value.findIndex(t=>[t.id,t.color,t.size].join()===[f,s,i].join());d("on-submit",v,E,e),h(),D.onClose(),R.success("\u63D0\u4EA4\u6210\u529F")}else console.log("\u63D0\u4EA4\u5931\u8D25",o),R.error("\u4ED3\u5E93\u91CC\u6CA1\u6709\u8FD9\u53CC\u978B")})}function M(n,l){!n||(h(),l())}function U(n){!n||(h(),D.onClose())}function h(){e.id="",e.price="",e.color="",e.size="",e.note=""}return(n,l)=>{const o=K,f=W,s=ee,i=oe,v=L,E=le,t=te;return g(),S("div",_e,[u(t,ie(m($),{"close-on-click-modal":!1,"before-close":a=>M(C.value,a)}),{default:r(()=>[u(E,{ref_key:"ruleFormRef",ref:C,model:e,rules:B,"label-width":52},{default:r(()=>[u(s,{label:"\u8D27\u53F7",prop:"id"},{default:r(()=>[u(f,{modelValue:e.id,"onUpdate:modelValue":l[0]||(l[0]=a=>e.id=a),filterable:"","allow-create":"",placeholder:"001"},{default:r(()=>[(g(!0),S(q,null,P(_.value,({label:a,value:F})=>(g(),T(o,{key:F,label:a,value:F},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"\u4EF7\u683C",prop:"price"},{default:r(()=>[u(i,{modelValue:e.price,"onUpdate:modelValue":l[1]||(l[1]=a=>e.price=a),placeholder:"55"},null,8,["modelValue"])]),_:1}),u(s,{label:"\u989C\u8272",prop:"color"},{default:r(()=>[u(f,{modelValue:e.color,"onUpdate:modelValue":l[2]||(l[2]=a=>e.color=a),filterable:"","allow-create":"",placeholder:"\u7EA2"},{default:r(()=>[(g(!0),S(q,null,P(x.value,({label:a,value:F})=>(g(),T(o,{key:F,label:a,value:F},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"\u5C3A\u7801",prop:"size"},{default:r(()=>[u(f,{modelValue:e.size,"onUpdate:modelValue":l[3]||(l[3]=a=>e.size=a),filterable:"","allow-create":"",placeholder:"35"},{default:r(()=>[(g(!0),S(q,null,P(Y.value,({label:a,value:F})=>(g(),T(o,{key:F,label:a,value:F},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"\u5907\u6CE8",prop:"note"},{default:r(()=>[u(i,{modelValue:e.note,"onUpdate:modelValue":l[4]||(l[4]=a=>e.note=a),type:"textarea",rows:2,placeholder:"\u672A\u4ED8\u6B3E"},null,8,["modelValue"])]),_:1}),u(s,{class:"!mb-0"},{default:r(()=>[z("div",be,[u(v,{type:"primary",onClick:l[5]||(l[5]=a=>U(C.value))},{default:r(()=>[ve]),_:1}),u(v,{type:"primary",onClick:l[6]||(l[6]=a=>I(C.value))},{default:r(()=>[Ee]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},16,["before-close"])])}}});function Ce(A,d,D){const p=J("emitter"),b=k([]),c=k(0);function V(e,B){D("\u7F16\u8F91"),c.value=e,p.emit("onEdit",B)}function $(e){const B=A.value.filter((w,_)=>_===e);A.value=A.value.filter((w,_)=>_!==e),d.value=d.value.concat(B)}function C(e){b.value=e}return{tableData:b,currIndex:c,onEdit:V,onDelete:$,refresh:C}}const Fe={class:"Stock"},ge={flex:"","mb-4":"","content-center":""},ke={"font-bold":""},ye={"font-bold":"","ml-8":""},Ve=z("div",{"flex-1":""},null,-1),Be=y(" \u6DFB\u52A0 "),we=y(" \u4FDD\u5B58 "),Ae=y(" \u7F16\u8F91 "),xe=y(" \u5220\u9664 "),ze=X({__name:"account",setup(A){const{g_account:d,g_stock:D}=Z(Q()),p=k([]),{visible:b,title:c,onShow:V,onClose:$}=pe(d),{tableData:C,currIndex:e,onEdit:B,onDelete:w,refresh:_}=Ce(d,D,V),{isQuery:x,onSave:Y}=fe(d,p,_),I=k(new Date),M=de(()=>p.value.reduce((l,o)=>l+Number(o.price),0));H(()=>{x.value?x.value=!1:U(d.value)});function U(l){p.value=l,_(p.value)}function h(l){x.value=!0,p.value=d.value.filter(o=>N(o.time).format("YYYYMMDD")===N(l).format("YYYYMMDD")),_(p.value)}function n(l,o,f){if(c.value==="\u7F16\u8F91"){const s=d.value.findIndex((i,v)=>v===e.value);d.value.splice(s,1,l)}else c.value==="\u65B0\u589E"&&l&&(D.value=D.value.filter((s,i)=>i!==o),d.value=d.value.concat({...l,price:f.price,note:f.note,time:Date.now()}))}return(l,o)=>{const f=ae,s=L,i=ue,v=ne,E=De;return g(),S("div",Fe,[z("div",ge,[z("p",ke," \u603B\u91CF: "+j(p.value.length)+"\u53CC ",1),z("p",ye," \u603B\u4EF7: "+j(m(M))+"\u5143 ",1),Ve,u(f,{modelValue:I.value,"onUpdate:modelValue":o[0]||(o[0]=t=>I.value=t),type:"date",placeholder:"Pick a day",onChange:h},null,8,["modelValue"]),u(s,{"ml-4":"",type:"primary",onClick:o[1]||(o[1]=t=>m(V)("\u65B0\u589E"))},{default:r(()=>[Be]),_:1}),u(s,{type:"primary",onClick:o[2]||(o[2]=t=>m(Y)(m(d),"account"))},{default:r(()=>[we]),_:1})]),u(v,{data:m(C),border:!0},{default:r(()=>[u(i,{label:"\u8D27\u53F7",prop:"id"}),u(i,{label:"\u5382\u5546",prop:"name"}),u(i,{label:"\u989C\u8272"},{default:r(t=>[z("i",{class:me({"bg-red":t.row.color==="\u7EA2","bg-pink":t.row.color==="\u7C89","bg-orange":t.row.color==="\u6A59","bg-yellow":t.row.color==="\u9EC4","bg-green":t.row.color==="\u7EFF","bg-cyan":t.row.color==="\u9752","bg-blue":t.row.color==="\u84DD","bg-purple":t.row.color==="\u7D2B","bg-stone":t.row.color==="\u68D5","bg-black":t.row.color==="\u9ED1","bg-gray-2":t.row.color==="\u767D","bg-gray":t.row.color==="\u7070"}),"i-mdi:shoe-sneaker":"","text-18px":""},null,2),y(" "+j(t.row.color),1)]),_:1}),u(i,{label:"\u5C3A\u7801",prop:"size"}),u(i,{label:"\u4EF7\u683C",prop:"price"}),u(i,{label:"\u65F6\u95F4"},{default:r(t=>[y(j(m(N)(t.row.time).format("YYYY-MM-DD")),1)]),_:1}),u(i,{label:"\u5907\u6CE8",prop:"note"}),u(i,{label:"\u64CD\u4F5C"},{default:r(t=>[u(s,{size:"small",onClick:a=>m(B)(t.$index,t.row)},{default:r(()=>[Ae]),_:2},1032,["onClick"]),u(s,{size:"small",type:"danger",onClick:a=>m(w)(t.$index)},{default:r(()=>[xe]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),u(E,{modelValue:m(b),"onUpdate:modelValue":o[3]||(o[3]=t=>ce(b)?b.value=t:null),title:m(c),"on-close":m($),onOnSubmit:n},null,8,["modelValue","title","on-close"])])}}});typeof O=="function"&&O(ze);export{ze as default};
