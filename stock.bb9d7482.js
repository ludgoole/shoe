import{d as Q,a as te,r as U,b as H,A as ae,f as K,e as L,E as P,c as W,g as X,h as Z,i as ne,o as i,j as F,k as e,l,m as re,n as a,p as ee,t as le,F as B,q as z,s as x,v as _,y as se,z as S,x as de,u as ie,w as me,B as ce,C as pe,G as fe,D as A,J as _e,H as be,K as J}from"./assets/index.a9e29215.js";import{u as Ee,a as Fe}from"./use-form.7f600280.js";const ge={class:"StockAdd"},Ce={flex:"~ 1","justify-end":""},De=_(" \u53D6\u6D88 "),Ve=_(" \u63D0\u4EA4 "),ke=Q({__name:"StockAdd",props:{names:null,onClose:null},emits:["on-submit"],setup(q,{emit:g}){const b=q,k=ee("emitter"),$=te(),C=U(),t=H({id:"",price:"",name:"",colors:[],sizes:[],area:""}),I=H({id:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D27\u53F7",trigger:"blur"}],price:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EF7\u683C",trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u9009\u62E9\u5382\u5546",trigger:"blur"}],colors:[{required:!0,message:"\u8BF7\u9009\u62E9\u989C\u8272",trigger:"blur"}],sizes:[{required:!0,message:"\u8BF7\u9009\u62E9\u5C3A\u7801",trigger:"blur"}],area:[{required:!0,message:"\u8BF7\u9009\u62E9\u4F4D\u7F6E",trigger:"blur"}]}),D=s=>({value:s,label:s}),h=ae(()=>le(b).names.value.filter(s=>s.value)),T=U(["\u7EA2","\u7C89","\u6A59","\u9EC4","\u7EFF","\u9752","\u84DD","\u7D2B","\u68D5","\u9ED1","\u767D","\u7070"].map(D)),R=U(["33","34","35","36","37","38","39","40","41","42","43","44","45"].map(D)),c=U(["A","B","C","D","E","F","G","H","I","J"].map(D));k.off("onEdit"),k.on("onEdit",s=>{t.id=s.id,t.price=s.price,t.name=s.name,t.colors=s.children.map(r=>r.color),t.sizes=s.children.reduce((r,f)=>[...new Set(r.concat(f.sizes))].sort(),[]),t.area=s.area});async function Y(s){if(!s)return;await s.validate((f,p)=>{f?(g("on-submit",r(),t.id),O(),b.onClose(),se.success("\u63D0\u4EA4\u6210\u529F")):console.log("error submit!",p)});function r(){const f=[],{colors:p,sizes:v,id:V="",price:d="",name:w="",area:y=""}=t;return p.forEach(u=>{v.forEach(m=>{f.push({id:V,price:d||"--",name:w||"--",area:y||"--",color:u,size:m,time:Date.now()})})}),f}}function G(s,r){!s||(O(),r())}function M(s){!s||(O(),b.onClose())}function O(){t.id="",t.price="",t.name="",t.colors=[],t.sizes=[],t.area=""}return(s,r)=>{const f=K,p=L,v=P,V=W,d=X,w=Z,y=ne;return i(),F("div",ge,[e(y,re(a($),{"close-on-click-modal":!1,"before-close":u=>G(C.value,u)}),{default:l(()=>[e(w,{ref_key:"ruleFormRef",ref:C,model:t,rules:I},{default:l(()=>[e(p,{label:"\u8D27\u53F7",prop:"id"},{default:l(()=>[e(f,{modelValue:t.id,"onUpdate:modelValue":r[0]||(r[0]=u=>t.id=u),placeholder:"001"},null,8,["modelValue"])]),_:1}),e(p,{label:"\u4EF7\u683C",prop:"price"},{default:l(()=>[e(f,{modelValue:t.price,"onUpdate:modelValue":r[1]||(r[1]=u=>t.price=u),placeholder:"55"},null,8,["modelValue"])]),_:1}),e(p,{label:"\u5382\u5546",prop:"name"},{default:l(()=>[e(V,{modelValue:t.name,"onUpdate:modelValue":r[2]||(r[2]=u=>t.name=u),filterable:"","allow-create":"",placeholder:"\u53E4\u96F2\u8F69"},{default:l(()=>[(i(!0),F(B,null,z(a(h),({label:u,value:m})=>(i(),S(v,{key:m,label:u,value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"\u989C\u8272",prop:"colors"},{default:l(()=>[e(V,{modelValue:t.colors,"onUpdate:modelValue":r[3]||(r[3]=u=>t.colors=u),multiple:"",filterable:"","allow-create":"",placeholder:"\u7EA2 \u7C89"},{default:l(()=>[(i(!0),F(B,null,z(T.value,({label:u,value:m})=>(i(),S(v,{key:m,label:u,value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"\u5C3A\u7801",prop:"sizes"},{default:l(()=>[e(V,{modelValue:t.sizes,"onUpdate:modelValue":r[4]||(r[4]=u=>t.sizes=u),multiple:"",filterable:"","allow-create":"",placeholder:"35 36 37"},{default:l(()=>[(i(!0),F(B,null,z(R.value,({label:u,value:m})=>(i(),S(v,{key:m,label:u,value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"\u4F4D\u7F6E",prop:"area"},{default:l(()=>[e(V,{modelValue:t.area,"onUpdate:modelValue":r[5]||(r[5]=u=>t.area=u),filterable:"","allow-create":"",placeholder:"A"},{default:l(()=>[(i(!0),F(B,null,z(c.value,({label:u,value:m})=>(i(),S(v,{key:m,label:u,value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{class:"!mb-0"},{default:l(()=>[x("div",Ce,[e(d,{type:"primary",onClick:r[6]||(r[6]=u=>M(C.value))},{default:l(()=>[De]),_:1}),e(d,{type:"primary",onClick:r[7]||(r[7]=u=>Y(C.value))},{default:l(()=>[Ve]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},16,["before-close"])])}}});function ve(q,g){const{getTreeStock:b}=de(),k=ee("emitter"),$=U([]);function C(D,h){g("\u7F16\u8F91"),k.emit("onEdit",h)}function t(D,h){q.value=q.value.filter(T=>T.id!==h.id)}function I(D){$.value=b(D)}return{tableData:$,onEdit:C,onDelete:t,refresh:I}}const we={class:"Stock"},ye=_(" \u67E5\u8BE2 "),Ae=_(" \u6DFB\u52A0 "),Be=_(" \u4FDD\u5B58 "),ze={m:"4"},Se={m:"t-0 b-2"},he={m:"t-0 b-2"},xe={m:"t-0 b-2"},$e=_(" \u7F16\u8F91 "),Ue=_(" \u5220\u9664 "),qe=Q({__name:"stock",setup(q){const{g_stock:g}=le(ie()),b=U([]),{visible:k,title:$,onShow:C,onClose:t,onSubmit:I}=Ee(g),{tableData:D,onEdit:h,onDelete:T,refresh:R}=ve(g,C),{form:c,isQuery:Y,names:G,colors:M,areas:O,sizes:s,initSelect:r,onQuery:f,onSave:p}=Fe(g,b,R);me(()=>{Y.value?Y.value=!1:v(g.value)});function v(V){b.value=V,r(b.value),R(b.value)}return(V,d)=>{const w=P,y=W,u=L,m=K,j=X,oe=Z,E=ce,N=pe,ue=ke;return i(),F("div",we,[e(oe,{inline:"",relative:"",flex:"",model:a(c)},{default:l(()=>[e(u,{label:"\u5382\u5546","w-50":""},{default:l(()=>[e(y,{modelValue:a(c).name,"onUpdate:modelValue":d[0]||(d[0]=o=>a(c).name=o),placeholder:"\u53E4\u96F2\u8F69"},{default:l(()=>[(i(!0),F(B,null,z(a(G),({label:o,value:n})=>(i(),S(w,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"\u989C\u8272","w-50":""},{default:l(()=>[e(y,{modelValue:a(c).color,"onUpdate:modelValue":d[1]||(d[1]=o=>a(c).color=o),placeholder:"\u7EA2"},{default:l(()=>[(i(!0),F(B,null,z(a(M),({label:o,value:n})=>(i(),S(w,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"\u5C3A\u7801","w-50":""},{default:l(()=>[e(y,{modelValue:a(c).size,"onUpdate:modelValue":d[2]||(d[2]=o=>a(c).size=o),placeholder:"35"},{default:l(()=>[(i(!0),F(B,null,z(a(s),({label:o,value:n})=>(i(),S(w,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"\u4F4D\u7F6E","w-50":""},{default:l(()=>[e(y,{modelValue:a(c).area,"onUpdate:modelValue":d[3]||(d[3]=o=>a(c).area=o),placeholder:"A"},{default:l(()=>[(i(!0),F(B,null,z(a(O),({label:o,value:n})=>(i(),S(w,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"\u8D27\u53F7","w-50":""},{default:l(()=>[e(m,{modelValue:a(c).id,"onUpdate:modelValue":d[4]||(d[4]=o=>a(c).id=o),placeholder:"001"},null,8,["modelValue"])]),_:1}),e(u,{"ml-auto":"",class:"!mr-0"},{default:l(()=>[e(j,{type:"primary",onClick:a(f)},{default:l(()=>[ye]),_:1},8,["onClick"]),e(j,{type:"primary",onClick:d[5]||(d[5]=o=>a(C)("\u65B0\u589E"))},{default:l(()=>[Ae]),_:1}),e(j,{type:"primary",onClick:d[6]||(d[6]=o=>a(p)(a(g),"stock"))},{default:l(()=>[Be]),_:1})]),_:1})]),_:1},8,["model"]),e(N,{data:a(D),border:!0},{default:l(()=>[e(E,{type:"expand"},{default:l(o=>[x("div",ze,[x("p",Se," \u8D27\u53F7: "+A(o.row.id),1),x("p",he," \u5382\u5546: "+A(o.row.name),1),x("p",xe," \u4EF7\u683C: "+A(o.row.price),1),x("h3",null,"\u6570\u91CF: "+A(o.row.children.length*o.row.children[0].sizes.length),1),e(N,{data:o.row.children,border:!0},{default:l(()=>[e(E,{label:"\u989C\u8272"},{default:l(n=>[x("i",{class:_e({"bg-red":n.row.color==="\u7EA2","bg-pink":n.row.color==="\u7C89","bg-orange":n.row.color==="\u6A59","bg-yellow":n.row.color==="\u9EC4","bg-green":n.row.color==="\u7EFF","bg-cyan":n.row.color==="\u9752","bg-blue":n.row.color==="\u84DD","bg-purple":n.row.color==="\u7D2B","bg-black":n.row.color==="\u9ED1","bg-gray-2":n.row.color==="\u767D","bg-gray":n.row.color==="\u7070"}),"i-mdi:shoe-sneaker":"","text-18px":""},null,2),_(" "+A(n.row.color),1)]),_:1}),e(E,{label:"\u5C3A\u7801"},{default:l(n=>[_(A(n.row.sizes.sort().join(" ")),1)]),_:1})]),_:2},1032,["data"])])]),_:1}),e(E,{label:"\u8D27\u53F7",prop:"id"}),e(E,{label:"\u5382\u5546",prop:"name"}),e(E,{label:"\u4EF7\u683C",prop:"price"}),e(E,{label:"\u6570\u91CF"},{default:l(o=>[_(A(o.row.children.length*o.row.children[0].sizes.length),1)]),_:1}),e(E,{label:"\u4F4D\u7F6E",prop:"area"}),e(E,{label:"\u65F6\u95F4"},{default:l(o=>[_(A(a(be)(o.row.time).format("YYYY-MM-DD")),1)]),_:1}),e(E,{label:"\u64CD\u4F5C"},{default:l(o=>[e(j,{size:"small",onClick:n=>a(h)(o.$index,o.row)},{default:l(()=>[$e]),_:2},1032,["onClick"]),e(j,{size:"small",type:"danger",onClick:n=>a(T)(o.$index,o.row)},{default:l(()=>[Ue]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(ue,{modelValue:a(k),"onUpdate:modelValue":d[7]||(d[7]=o=>fe(k)?k.value=o:null),title:a($),names:a(G),"on-close":a(t),onOnSubmit:a(I)},null,8,["modelValue","title","names","on-close","onOnSubmit"])])}}});typeof J=="function"&&J(qe);export{qe as default};
