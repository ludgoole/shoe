import{d as Q,a as ae,r as U,b as H,A as ne,f as K,e as L,E as P,c as W,g as X,h as Z,i as re,o as m,j as g,k as e,l,m as se,n as a,p as ee,t as le,F as B,q as z,s as h,v as _,y as de,z as S,x as ie,u as me,w as ce,B as pe,C as fe,G as _e,D as A,J as be,H as Ee,K as J}from"./assets/index.ec56810d.js";import{u as Fe,a as ge}from"./use-form.14af79ae.js";const Ce={class:"StockAdd"},De={flex:"~ 1","justify-end":""},Ve=_(" \u53D6\u6D88 "),ke=_(" \u63D0\u4EA4 "),ve=Q({__name:"StockAdd",props:{names:null,onClose:null},emits:["on-submit"],setup(q,{emit:C}){const b=q,w=ee("emitter"),$=ae(),D=U(),u=H({id:"",price:"",name:"",colors:[],sizes:[],area:""}),I=H({id:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D27\u53F7",trigger:"blur"}],price:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EF7\u683C",trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u9009\u62E9\u5382\u5546",trigger:"blur"}],colors:[{required:!0,message:"\u8BF7\u9009\u62E9\u989C\u8272",trigger:"blur"}],sizes:[{required:!0,message:"\u8BF7\u9009\u62E9\u5C3A\u7801",trigger:"blur"}],area:[{required:!0,message:"\u8BF7\u9009\u62E9\u4F4D\u7F6E",trigger:"blur"}]}),V=d=>({value:d,label:d}),x=ne(()=>le(b).names.value.filter(d=>d.value)),T=U(["\u7EA2","\u7C89","\u6A59","\u9EC4","\u7EFF","\u9752","\u84DD","\u7D2B","\u68D5","\u9ED1","\u767D","\u7070"].map(V)),R=U(["33","34","35","36","37","38","39","40","41","42","43","44","45"].map(V)),c=U(["A","B","C","D","E","F","G","H","I","J"].map(V));w.off("onEdit"),w.on("onEdit",d=>{u.id=d.id,u.price=d.price,u.name=d.name,u.colors=d.children.map(r=>r.color),u.sizes=d.children.reduce((r,f)=>[...new Set(r.concat(f.sizes))].sort(),[]),u.area=d.area});async function Y(d){if(!d)return;await d.validate((f,p)=>{f?(C("on-submit",r(),u.id),O(),b.onClose(),de.success("\u63D0\u4EA4\u6210\u529F")):console.log("error submit!",p)});function r(){const f=[],{colors:p,sizes:y,id:k="",price:v="",name:s="",area:E=""}=u;return p.forEach(t=>{y.forEach(i=>{f.push({id:k,price:v||"--",name:s||"--",area:E||"--",color:t,size:i,time:Date.now()})})}),f}}function G(d,r){!d||(O(),r())}function M(d){!d||(O(),b.onClose())}function O(){u.id="",u.price="",u.name="",u.colors=[],u.sizes=[],u.area=""}return(d,r)=>{const f=K,p=L,y=P,k=W,v=X,s=Z,E=re;return m(),g("div",Ce,[e(E,se(a($),{"close-on-click-modal":!1,"before-close":t=>G(D.value,t)}),{default:l(()=>[e(s,{ref_key:"ruleFormRef",ref:D,model:u,rules:I},{default:l(()=>[e(p,{label:"\u8D27\u53F7",prop:"id"},{default:l(()=>[e(f,{modelValue:u.id,"onUpdate:modelValue":r[0]||(r[0]=t=>u.id=t),placeholder:"001"},null,8,["modelValue"])]),_:1}),e(p,{label:"\u4EF7\u683C",prop:"price"},{default:l(()=>[e(f,{modelValue:u.price,"onUpdate:modelValue":r[1]||(r[1]=t=>u.price=t),placeholder:"55"},null,8,["modelValue"])]),_:1}),e(p,{label:"\u5382\u5546",prop:"name"},{default:l(()=>[e(k,{modelValue:u.name,"onUpdate:modelValue":r[2]||(r[2]=t=>u.name=t),filterable:"","allow-create":"",placeholder:"\u53E4\u96F2\u8F69"},{default:l(()=>[(m(!0),g(B,null,z(a(x),({label:t,value:i})=>(m(),S(y,{key:i,label:t,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"\u989C\u8272",prop:"colors"},{default:l(()=>[e(k,{modelValue:u.colors,"onUpdate:modelValue":r[3]||(r[3]=t=>u.colors=t),multiple:"",filterable:"","allow-create":"",placeholder:"\u7EA2 \u7C89"},{default:l(()=>[(m(!0),g(B,null,z(T.value,({label:t,value:i})=>(m(),S(y,{key:i,label:t,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"\u5C3A\u7801",prop:"sizes"},{default:l(()=>[e(k,{modelValue:u.sizes,"onUpdate:modelValue":r[4]||(r[4]=t=>u.sizes=t),multiple:"",filterable:"","allow-create":"",placeholder:"35 36 37"},{default:l(()=>[(m(!0),g(B,null,z(R.value,({label:t,value:i})=>(m(),S(y,{key:i,label:t,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"\u4F4D\u7F6E",prop:"area"},{default:l(()=>[e(k,{modelValue:u.area,"onUpdate:modelValue":r[5]||(r[5]=t=>u.area=t),filterable:"","allow-create":"",placeholder:"A"},{default:l(()=>[(m(!0),g(B,null,z(c.value,({label:t,value:i})=>(m(),S(y,{key:i,label:t,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{class:"!mb-0"},{default:l(()=>[h("div",De,[e(v,{type:"primary",onClick:r[6]||(r[6]=t=>M(D.value))},{default:l(()=>[Ve]),_:1}),e(v,{type:"primary",onClick:r[7]||(r[7]=t=>Y(D.value))},{default:l(()=>[ke]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},16,["before-close"])])}}});function we(q,C){const{getTreeStock:b}=ie(),w=ee("emitter"),$=U([]);function D(V,x){C("\u7F16\u8F91"),w.emit("onEdit",x)}function u(V,x){q.value=q.value.filter(T=>T.id!==x.id)}function I(V){$.value=b(V)}return{tableData:$,onEdit:D,onDelete:u,refresh:I}}const ye={class:"Stock"},Ae=_(" \u67E5\u8BE2 "),Be=_(" \u6DFB\u52A0 "),ze=_(" \u4FDD\u5B58 "),Se={m:"4"},xe={m:"t-0 b-2"},he={m:"t-0 b-2"},$e={m:"t-0 b-2"},Ue=_(" \u7F16\u8F91 "),qe=_(" \u5220\u9664 "),Ie=Q({__name:"stock",setup(q){const{g_stock:C}=le(me()),b=U([]),{visible:w,title:$,onShow:D,onClose:u,onSubmit:I}=Fe(C),{tableData:V,onEdit:x,onDelete:T,refresh:R}=we(C,D),{form:c,isQuery:Y,names:G,colors:M,areas:O,sizes:d,initSelect:r,onQuery:f,onSave:p}=ge(C,b,R);ce(()=>{Y.value?Y.value=!1:y(C.value)});function y(v){b.value=v,r(b.value),R(b.value)}function k(v){return v.children.reduce((s,E)=>s+E.sizes.length,0)}return(v,s)=>{const E=P,t=W,i=L,oe=K,j=X,ue=Z,F=pe,N=fe,te=ve;return m(),g("div",ye,[e(ue,{inline:"",relative:"",flex:"",model:a(c)},{default:l(()=>[e(i,{label:"\u5382\u5546","w-50":""},{default:l(()=>[e(t,{modelValue:a(c).name,"onUpdate:modelValue":s[0]||(s[0]=o=>a(c).name=o),placeholder:"\u53E4\u96F2\u8F69"},{default:l(()=>[(m(!0),g(B,null,z(a(G),({label:o,value:n})=>(m(),S(E,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u989C\u8272","w-50":""},{default:l(()=>[e(t,{modelValue:a(c).color,"onUpdate:modelValue":s[1]||(s[1]=o=>a(c).color=o),placeholder:"\u7EA2"},{default:l(()=>[(m(!0),g(B,null,z(a(M),({label:o,value:n})=>(m(),S(E,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u5C3A\u7801","w-50":""},{default:l(()=>[e(t,{modelValue:a(c).size,"onUpdate:modelValue":s[2]||(s[2]=o=>a(c).size=o),placeholder:"35"},{default:l(()=>[(m(!0),g(B,null,z(a(d),({label:o,value:n})=>(m(),S(E,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u4F4D\u7F6E","w-50":""},{default:l(()=>[e(t,{modelValue:a(c).area,"onUpdate:modelValue":s[3]||(s[3]=o=>a(c).area=o),placeholder:"A"},{default:l(()=>[(m(!0),g(B,null,z(a(O),({label:o,value:n})=>(m(),S(E,{key:n,label:o,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u8D27\u53F7","w-50":""},{default:l(()=>[e(oe,{modelValue:a(c).id,"onUpdate:modelValue":s[4]||(s[4]=o=>a(c).id=o),placeholder:"001"},null,8,["modelValue"])]),_:1}),e(i,{"ml-auto":"",class:"!mr-0"},{default:l(()=>[e(j,{type:"primary",onClick:a(f)},{default:l(()=>[Ae]),_:1},8,["onClick"]),e(j,{type:"primary",onClick:s[5]||(s[5]=o=>a(D)("\u65B0\u589E"))},{default:l(()=>[Be]),_:1}),e(j,{type:"primary",onClick:s[6]||(s[6]=o=>a(p)(a(C),"stock"))},{default:l(()=>[ze]),_:1})]),_:1})]),_:1},8,["model"]),e(N,{data:a(V),border:!0},{default:l(()=>[e(F,{type:"expand"},{default:l(o=>[h("div",Se,[h("p",xe," \u8D27\u53F7: "+A(o.row.id),1),h("p",he," \u5382\u5546: "+A(o.row.name),1),h("p",$e," \u4EF7\u683C: "+A(o.row.price),1),h("h3",null,"\u6570\u91CF: "+A(k(o.row)),1),e(N,{"mt-4":"",data:o.row.children,border:!0},{default:l(()=>[e(F,{label:"\u989C\u8272"},{default:l(n=>[h("i",{class:be({"bg-red":n.row.color==="\u7EA2","bg-pink":n.row.color==="\u7C89","bg-orange":n.row.color==="\u6A59","bg-yellow":n.row.color==="\u9EC4","bg-green":n.row.color==="\u7EFF","bg-cyan":n.row.color==="\u9752","bg-blue":n.row.color==="\u84DD","bg-purple":n.row.color==="\u7D2B","bg-black":n.row.color==="\u9ED1","bg-gray-2":n.row.color==="\u767D","bg-gray":n.row.color==="\u7070"}),"i-mdi:shoe-sneaker":"","text-18px":""},null,2),_(" "+A(n.row.color),1)]),_:1}),e(F,{label:"\u5C3A\u7801"},{default:l(n=>[_(A(n.row.sizes.sort().join(" ")),1)]),_:1})]),_:2},1032,["data"])])]),_:1}),e(F,{label:"\u8D27\u53F7",prop:"id"}),e(F,{label:"\u5382\u5546",prop:"name"}),e(F,{label:"\u4EF7\u683C",prop:"price"}),e(F,{label:"\u6570\u91CF"},{default:l(o=>[_(A(k(o.row)),1)]),_:1}),e(F,{label:"\u4F4D\u7F6E",prop:"area"}),e(F,{label:"\u65F6\u95F4"},{default:l(o=>[_(A(a(Ee)(o.row.time).format("YYYY-MM-DD")),1)]),_:1}),e(F,{label:"\u64CD\u4F5C"},{default:l(o=>[e(j,{size:"small",onClick:n=>a(x)(o.$index,o.row)},{default:l(()=>[Ue]),_:2},1032,["onClick"]),e(j,{size:"small",type:"danger",onClick:n=>a(T)(o.$index,o.row)},{default:l(()=>[qe]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(te,{modelValue:a(w),"onUpdate:modelValue":s[7]||(s[7]=o=>_e(w)?w.value=o:null),title:a($),names:a(G),"on-close":a(u),onOnSubmit:a(I)},null,8,["modelValue","title","names","on-close","onOnSubmit"])])}}});typeof J=="function"&&J(Ie);export{Ie as default};
